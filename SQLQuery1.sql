CREATE DATABASE CarsDB;
GO
USE CarsDB;

CREATE TABLE Manufacturer
(
	ManufacturerId INT PRIMARY KEY,
	ManufacturerName NVARCHAR(15),
	ManufacturerCountry NVARCHAR(15)
);
CREATE TABLE Model
(
	ModelId INT PRIMARY KEY,
	ModelName NVARCHAR(15),
	ModelProductionDate DATE,
	ModelBodyType NVARCHAR(10)
);
CREATE TABLE Registration
(
	RegistrationId INT PRIMARY KEY,
	RegistrationNumber NVARCHAR(10),
	RegistrationDate DATE,
	RegistrationOperation NVARCHAR(40)
);
CREATE TABLE GeneralInformation
(
	GeneralInformationId INT PRIMARY KEY,
	ManufacturerId INT NOT NULL
		FOREIGN KEY REFERENCES Manufacturer(ManufacturerId),
	ModelId INT NOT NULL
		FOREIGN KEY REFERENCES Model(ModelId),
	RegistrationId INT NOT NULL
		FOREIGN KEY REFERENCES Registration(RegistrationId)
);

INSERT Manufacturer VALUES(1, 'Audi', 'Germany')
INSERT Manufacturer VALUES(2, 'BMW', 'Germany')
INSERT Manufacturer VALUES(3, 'Mercedes-Benz', 'Germany')
INSERT Manufacturer VALUES(4, 'Nissan', 'Japan')
INSERT Manufacturer VALUES(5, 'Volkswagen', 'Germany')
INSERT Manufacturer VALUES(6, 'Hyundai', 'South Korea')
INSERT Manufacturer VALUES(7, 'Mazda', 'Japan')

INSERT Model VALUES(1, 'A4', '2020-07-01', 'Sedan')
INSERT Model VALUES(2, 'A4', '2019-11-15', 'Sedan')
INSERT Model VALUES(3, 'A4', '2018-01-16', 'Sedan')
INSERT Model VALUES(4, 'A4', '2017-04-10', 'Sedan')
INSERT Model VALUES(5, 'A4', '2016-07-01', 'Sedan')
INSERT Model VALUES(6, 'A4', '2015-11-15', 'Sedan')
INSERT Model VALUES(7, 'A6', '2018-07-01', 'Sedan')
INSERT Model VALUES(8, 'A6', '2017-08-19', 'Sedan')
INSERT Model VALUES(9, 'A6', '2015-06-21', 'Sedan')
INSERT Model VALUES(10, 'A6', '2014-04-26', 'Sedan')
INSERT Model VALUES(11, 'A8', '2020-09-25', 'Sedan')
INSERT Model VALUES(12, 'A8', '2015-07-01', 'Sedan')
INSERT Model VALUES(13, 'A8', '2014-03-02', 'Sedan')
INSERT Model VALUES(14, '3 series', '2019-01-20', 'Sedan')
INSERT Model VALUES(15, '3 series', '2017-12-19', 'Sedan')
INSERT Model VALUES(16, '3 series', '2015-07-23', 'Sedan')
INSERT Model VALUES(17, '5 series', '2017-07-16', 'Sedan')
INSERT Model VALUES(18, '5 series', '2016-04-22', 'Sedan')
INSERT Model VALUES(19, '5 series', '2015-05-01', 'Sedan')
INSERT Model VALUES(20, 'X5', '2021-08-08', 'Jeep')
INSERT Model VALUES(21, 'X5', '2020-09-11', 'Jeep')
INSERT Model VALUES(22, 'X5', '2019-10-21', 'Jeep')
INSERT Model VALUES(23, 'C 300', '2016-07-01', 'Sedan')
INSERT Model VALUES(24, 'C 300', '2020-07-01', 'Sedan')
INSERT Model VALUES(25, 'C 300', '2019-11-15', 'Sedan')
INSERT Model VALUES(26, 'C 250', '2018-01-16', 'Sedan')
INSERT Model VALUES(27, 'C 250', '2017-04-10', 'Sedan')
INSERT Model VALUES(28, 'C 200', '2016-07-01', 'Sedan')
INSERT Model VALUES(29, 'E 300', '2016-07-01', 'Sedan')
INSERT Model VALUES(30, 'E 300', '2020-07-01', 'Sedan')
INSERT Model VALUES(31, 'E 300', '2019-11-15', 'Sedan')
INSERT Model VALUES(32, 'E 220', '2018-01-16', 'Sedan')
INSERT Model VALUES(33, 'E 220', '2017-04-10', 'Sedan')
INSERT Model VALUES(34, 'E 220', '2016-07-01', 'Sedan')
INSERT Model VALUES(35, 'G 500', '2021-08-08', 'Jeep')
INSERT Model VALUES(36, 'G 500', '2020-09-11', 'Jeep')
INSERT Model VALUES(37, 'G 500', '2019-10-21', 'Jeep')
INSERT Model VALUES(38, 'Leaf', '2020-07-01', 'Hetchback')
INSERT Model VALUES(39, 'Leaf', '2019-11-15', 'Hetchback')
INSERT Model VALUES(40, 'Leaf', '2018-01-16', 'Hetchback')
INSERT Model VALUES(41, 'Leaf', '2017-04-10', 'Hetchback')
INSERT Model VALUES(42, 'Leaf', '2016-07-01', 'Hetchback')
INSERT Model VALUES(43, 'Rouge', '2020-07-01', 'Jeep')
INSERT Model VALUES(44, 'Rouge', '2019-11-15', 'Jeep')
INSERT Model VALUES(45, 'Rouge', '2018-01-16', 'Jeep')
INSERT Model VALUES(46, 'Rouge', '2017-04-10', 'Jeep')
INSERT Model VALUES(47, 'Rouge', '2016-07-01', 'Jeep')
INSERT Model VALUES(48, 'Golf', '2021-08-08', 'Hetchback')
INSERT Model VALUES(49, 'Golf', '2020-09-11', 'Hetchback')
INSERT Model VALUES(50, 'Golf', '2019-10-21', 'Hetchback')
INSERT Model VALUES(51, 'Passat', '2019-11-15', 'Sedan')
INSERT Model VALUES(52, 'Passat', '2018-01-16', 'Sedan')
INSERT Model VALUES(53, 'Passat', '2017-04-10', 'Sedan')
INSERT Model VALUES(54, 'Passat', '2016-07-01', 'Sedan')
INSERT Model VALUES(55, 'Passat', '2016-07-01', 'Sedan')
INSERT Model VALUES(56, 'Passat', '2020-07-01', 'Sedan')
INSERT Model VALUES(57, 'Polo', '2021-08-08', 'Hetchback')
INSERT Model VALUES(58, 'Polo', '2020-09-11', 'Hetchback')
INSERT Model VALUES(59, 'Polo', '2019-10-21', 'Hetchback')
INSERT Model VALUES(60, 'Elantra', '2020-07-01', 'Sedan')
INSERT Model VALUES(61, 'Elantra', '2019-11-15', 'Sedan')
INSERT Model VALUES(62, 'Elantra', '2018-01-16', 'Sedan')
INSERT Model VALUES(63, 'Elantra', '2017-04-10', 'Sedan')
INSERT Model VALUES(64, 'Elantra', '2016-07-01', 'Sedan')
INSERT Model VALUES(65, '3', '2020-07-01', 'Sedan')
INSERT Model VALUES(66, '3', '2019-11-15', 'Sedan')
INSERT Model VALUES(67, '3', '2018-01-16', 'Sedan')
INSERT Model VALUES(68, '3', '2017-04-10', 'Sedan')
INSERT Model VALUES(69, '3', '2016-07-01', 'Sedan')
INSERT Model VALUES(70, '6', '2019-11-15', 'Sedan')
INSERT Model VALUES(71, '6', '2018-01-16', 'Sedan')

INSERT Registration VALUES(1, 'AE0001AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(2, 'AE0002AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(3, 'AE0003AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(4, 'AE0004AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(5, 'AE0005AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(6, 'AE0006AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(7, 'AE0007AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(8, 'AE0008AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(9, 'AE0009AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(10, 'AE0010AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(11, 'AE0011AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(12, 'AE0012AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(13, 'AE0013AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(14, 'AE0014AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(15, 'AE0015AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(16, 'AE0016AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(17, 'AE1700AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(18, 'AE1701AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(19, 'AE0108AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(20, 'AE5623AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(21, 'AE7820AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(22, 'AE4462AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(23, 'AE7895AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(24, 'AE5536AE', '2022-01-01', 'First registration')
INSERT Registration VALUES(25, 'AE4875AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(26, 'AE3314AE', '2022-01-01', 'Second registration')
INSERT Registration VALUES(27, 'AE0469AB', '2022-01-01', 'First registration')
INSERT Registration VALUES(28, 'AE1039AB', '2022-01-01', 'Second registration')
INSERT Registration VALUES(29, 'AE3918AB', '2022-01-01', 'Second registration')
INSERT Registration VALUES(30, 'AE3919AB', '2022-01-02', 'First registration')
INSERT Registration VALUES(31, 'AA0001AE', '2022-01-02', 'First registration')
INSERT Registration VALUES(32, 'AA0002AE', '2022-01-02', 'First registration')
INSERT Registration VALUES(33, 'AA0003AE', '2022-01-02', 'First registration')
INSERT Registration VALUES(34, 'AA0004AE', '2022-01-02', 'First registration')
INSERT Registration VALUES(35, 'AA0005AE', '2022-01-02', 'Second registration')
INSERT Registration VALUES(36, 'AA0006AE', '2022-01-02', 'First registration')
INSERT Registration VALUES(37, 'AA0007AE', '2022-01-02', 'First registration')
INSERT Registration VALUES(38, 'AA0008AE', '2022-01-02', 'First registration')
INSERT Registration VALUES(39, 'AA0009AE', '2022-01-02', 'First registration')
INSERT Registration VALUES(40, 'AE1084PI', '2022-01-03', 'First registration')
INSERT Registration VALUES(41, 'AE1184PI', '2022-01-03', 'Second registration')
INSERT Registration VALUES(42, 'AE1284PI', '2022-01-03', 'Second registration')
INSERT Registration VALUES(43, 'AE3084PI', '2022-01-03', 'First registration')
INSERT Registration VALUES(44, 'AE6084PI', '2022-01-03', 'First registration')
INSERT Registration VALUES(45, 'AE1089PI', '2022-01-03', 'First registration')
INSERT Registration VALUES(46, 'AE1454PI', '2022-01-03', 'First registration')
INSERT Registration VALUES(47, 'AE1284PI', '2022-01-03', 'Second registration')
INSERT Registration VALUES(48, 'AE1494PI', '2022-01-03', 'Second registration')
INSERT Registration VALUES(49, 'AE2954PI', '2022-01-03', 'Second registration')
INSERT Registration VALUES(50, 'AE9954PI', '2022-01-03', 'First registration')
INSERT Registration VALUES(51, 'AI0110AE', '2022-01-03', 'Second registration')
INSERT Registration VALUES(52, 'AI0012AE', '2022-01-03', 'Second registration')
INSERT Registration VALUES(53, 'AI0013AE', '2022-01-03', 'First registration')
INSERT Registration VALUES(54, 'AI0014AE', '2022-01-03', 'First registration')
INSERT Registration VALUES(55, 'AI0015AE', '2022-01-03', 'First registration')
INSERT Registration VALUES(56, 'AI0016AE', '2022-01-03', 'First registration')
INSERT Registration VALUES(57, 'AI1700AE', '2022-01-03', 'Second registration')
INSERT Registration VALUES(58, 'AI1701AE', '2022-01-03', 'First registration')
INSERT Registration VALUES(59, 'AI0108AE', '2022-01-03', 'Second registration')
INSERT Registration VALUES(60, 'AI9108AE', '2022-01-03', 'Second registration')
INSERT Registration VALUES(61, 'AK0001AE', '2022-01-04', 'First registration')
INSERT Registration VALUES(62, 'AK0002AE', '2022-01-04', 'First registration')
INSERT Registration VALUES(63, 'AK0003AE', '2022-01-04', 'Second registration')
INSERT Registration VALUES(64, 'AK0004AE', '2022-01-04', 'First registration')
INSERT Registration VALUES(65, 'AK0005AE', '2022-01-04', 'First registration')
INSERT Registration VALUES(66, 'AK0006AE', '2022-01-04', 'Second registration')
INSERT Registration VALUES(67, 'AK0007AE', '2022-01-04', 'First registration')
INSERT Registration VALUES(68, 'AK0008AE', '2022-01-04', 'Second registration')
INSERT Registration VALUES(69, 'AK0009AE', '2022-01-04', 'First registration')
INSERT Registration VALUES(70, 'AE3099AK', '2022-01-04', 'First registration')
INSERT Registration VALUES(71, 'AE7339AA', '2022-01-04', 'First registration')

INSERT GeneralInformation VALUES(1, 1, 1, 1)
INSERT GeneralInformation VALUES(2, 1, 2, 2)
INSERT GeneralInformation VALUES(3, 1, 3, 3)
INSERT GeneralInformation VALUES(4, 1, 4, 4)
INSERT GeneralInformation VALUES(5, 1, 5, 5)
INSERT GeneralInformation VALUES(6, 1, 6, 6)
INSERT GeneralInformation VALUES(7, 1, 7, 7)
INSERT GeneralInformation VALUES(8, 1, 8, 8)
INSERT GeneralInformation VALUES(9, 1, 9, 9)
INSERT GeneralInformation VALUES(10, 1, 10, 10)
INSERT GeneralInformation VALUES(11, 1, 11, 11)
INSERT GeneralInformation VALUES(12, 1, 12, 12)
INSERT GeneralInformation VALUES(13, 1, 13, 13)
INSERT GeneralInformation VALUES(14, 2, 14, 14)
INSERT GeneralInformation VALUES(15, 2, 15, 15)
INSERT GeneralInformation VALUES(16, 2, 16, 16)
INSERT GeneralInformation VALUES(17, 2, 17, 17)
INSERT GeneralInformation VALUES(18, 2, 18, 18)
INSERT GeneralInformation VALUES(19, 2, 19, 19)
INSERT GeneralInformation VALUES(20, 2, 20, 20)
INSERT GeneralInformation VALUES(21, 2, 21, 21)
INSERT GeneralInformation VALUES(22, 2, 22, 22)
INSERT GeneralInformation VALUES(23, 3, 23, 23)
INSERT GeneralInformation VALUES(24, 3, 24, 24)
INSERT GeneralInformation VALUES(25, 3, 25, 25)
INSERT GeneralInformation VALUES(26, 3, 26, 26)
INSERT GeneralInformation VALUES(27, 3, 27, 27)
INSERT GeneralInformation VALUES(28, 3, 28, 28)
INSERT GeneralInformation VALUES(29, 3, 29, 29)
INSERT GeneralInformation VALUES(30, 3, 30, 30)
INSERT GeneralInformation VALUES(31, 3, 31, 31)
INSERT GeneralInformation VALUES(32, 3, 32, 32)
INSERT GeneralInformation VALUES(33, 3, 33, 33)
INSERT GeneralInformation VALUES(34, 3, 34, 34)
INSERT GeneralInformation VALUES(35, 3, 35, 35)
INSERT GeneralInformation VALUES(36, 3, 36, 36)
INSERT GeneralInformation VALUES(37, 3, 37, 37)
INSERT GeneralInformation VALUES(38, 4, 38, 38)
INSERT GeneralInformation VALUES(39, 4, 39, 39)
INSERT GeneralInformation VALUES(40, 4, 40, 40)
INSERT GeneralInformation VALUES(41, 4, 41, 41)
INSERT GeneralInformation VALUES(42, 4, 42, 42)
INSERT GeneralInformation VALUES(43, 4, 43, 43)
INSERT GeneralInformation VALUES(44, 4, 44, 44)
INSERT GeneralInformation VALUES(45, 4, 45, 45)
INSERT GeneralInformation VALUES(46, 4, 46, 46)
INSERT GeneralInformation VALUES(47, 4, 47, 47)
INSERT GeneralInformation VALUES(48, 5, 48, 48)
INSERT GeneralInformation VALUES(49, 5, 49, 49)
INSERT GeneralInformation VALUES(50, 5, 50, 50)
INSERT GeneralInformation VALUES(51, 5, 51, 51)
INSERT GeneralInformation VALUES(52, 5, 52, 52)
INSERT GeneralInformation VALUES(53, 5, 53, 53)
INSERT GeneralInformation VALUES(54, 5, 54, 54)
INSERT GeneralInformation VALUES(55, 5, 55, 55)
INSERT GeneralInformation VALUES(56, 5, 56, 56)
INSERT GeneralInformation VALUES(57, 5, 57, 57)
INSERT GeneralInformation VALUES(58, 5, 58, 58)
INSERT GeneralInformation VALUES(59, 5, 59, 59)
INSERT GeneralInformation VALUES(60, 6, 60, 60)
INSERT GeneralInformation VALUES(61, 6, 61, 61)
INSERT GeneralInformation VALUES(62, 6, 62, 62)
INSERT GeneralInformation VALUES(63, 6, 63, 63)
INSERT GeneralInformation VALUES(64, 6, 64, 64)
INSERT GeneralInformation VALUES(65, 7, 65, 65)
INSERT GeneralInformation VALUES(66, 7, 66, 66)
INSERT GeneralInformation VALUES(67, 7, 67, 67)
INSERT GeneralInformation VALUES(68, 7, 68, 68)
INSERT GeneralInformation VALUES(69, 7, 69, 69)
INSERT GeneralInformation VALUES(70, 7, 70, 70)
INSERT GeneralInformation VALUES(71, 7, 71, 71)

SELECT M.ManufacturerName AS Manufacturer, O.ModelName AS Model, R.RegistrationNumber AS NumberOfCar
FROM Manufacturer M JOIN GeneralInformation G
ON G.ManufacturerId = M.ManufacturerId JOIN Model O
	ON G.ModelId = O.ModelId JOIN Registration R
		ON G.RegistrationId = R.RegistrationId